--start_ignore
CREATE DATABASE diskquota;
CREATE
--end_ignore

!\retcode gpconfig -c shared_preload_libraries -v $(./data/current_binary_name);
-- start_ignore
20251211:00:07:53:067251 gpconfig:cdw:gpadmin-[INFO]:-completed successfully with parameters '-c shared_preload_libraries -v diskquota-2.3.so'

-- end_ignore
(exited with code 0)
!\retcode gpconfig -c diskquota.naptime -v 0 --skipvalidation;
-- start_ignore
20251211:00:07:53:067303 gpconfig:cdw:gpadmin-[INFO]:-completed successfully with parameters '-c diskquota.naptime -v 0 --skipvalidation'

-- end_ignore
(exited with code 0)
!\retcode gpconfig -c max_worker_processes -v 20 --skipvalidation;
-- start_ignore
20251211:00:07:53:067350 gpconfig:cdw:gpadmin-[INFO]:-completed successfully with parameters '-c max_worker_processes -v 20 --skipvalidation'

-- end_ignore
(exited with code 0)

!\retcode gpstop -raf;
-- start_ignore
20251211:00:07:53:067397 gpstop:cdw:gpadmin-[INFO]:-Starting gpstop with args: -raf
20251211:00:07:53:067397 gpstop:cdw:gpadmin-[INFO]:-Gathering information and validating the environment...
20251211:00:07:53:067397 gpstop:cdw:gpadmin-[INFO]:-Obtaining Cloudberry Coordinator catalog information
20251211:00:07:53:067397 gpstop:cdw:gpadmin-[INFO]:-Obtaining Segment details from coordinator...
20251211:00:07:53:067397 gpstop:cdw:gpadmin-[INFO]:-Cloudberry Version: 'postgres (Apache Cloudberry) 3.0.0-devel build dev'
20251211:00:07:53:067397 gpstop:cdw:gpadmin-[INFO]:-Commencing Coordinator instance shutdown with mode='fast'
20251211:00:07:53:067397 gpstop:cdw:gpadmin-[INFO]:-Coordinator segment instance directory=/home/gpadmin/cloudberry/gpAux/gpdemo/datadirs/qddir/demoDataDir-1
20251211:00:07:53:067397 gpstop:cdw:gpadmin-[INFO]:-Attempting forceful termination of any leftover coordinator process
20251211:00:07:53:067397 gpstop:cdw:gpadmin-[INFO]:-Terminating processes for segment /home/gpadmin/cloudberry/gpAux/gpdemo/datadirs/qddir/demoDataDir-1
20251211:00:07:53:067397 gpstop:cdw:gpadmin-[INFO]:-Stopping coordinator standby host cdw mode=fast
20251211:00:07:54:067397 gpstop:cdw:gpadmin-[INFO]:-Successfully shutdown standby process on cdw
20251211:00:07:54:067397 gpstop:cdw:gpadmin-[INFO]:-Targeting dbid [2, 5, 3, 6, 4, 7] for shutdown
20251211:00:07:54:067397 gpstop:cdw:gpadmin-[INFO]:-Commencing parallel primary segment instance shutdown, please wait...
20251211:00:07:54:067397 gpstop:cdw:gpadmin-[INFO]:-0.00% of jobs completed
20251211:00:07:57:067397 gpstop:cdw:gpadmin-[INFO]:-100.00% of jobs completed
20251211:00:07:57:067397 gpstop:cdw:gpadmin-[INFO]:-Commencing parallel mirror segment instance shutdown, please wait...
20251211:00:07:57:067397 gpstop:cdw:gpadmin-[INFO]:-0.00% of jobs completed
20251211:00:07:59:067397 gpstop:cdw:gpadmin-[INFO]:-100.00% of jobs completed
20251211:00:07:59:067397 gpstop:cdw:gpadmin-[INFO]:-----------------------------------------------------
20251211:00:07:59:067397 gpstop:cdw:gpadmin-[INFO]:-   Segments stopped successfully      = 6
20251211:00:07:59:067397 gpstop:cdw:gpadmin-[INFO]:-   Segments with errors during stop   = 0
20251211:00:07:59:067397 gpstop:cdw:gpadmin-[INFO]:-----------------------------------------------------
20251211:00:07:59:067397 gpstop:cdw:gpadmin-[INFO]:-Successfully shutdown 6 of 6 segment instances 
20251211:00:07:59:067397 gpstop:cdw:gpadmin-[INFO]:-Database successfully shutdown with no errors reported
20251211:00:07:59:067397 gpstop:cdw:gpadmin-[INFO]:-Restarting System...

-- end_ignore
(exited with code 0)

-- Show the values of all GUC variables
--start_ignore
-- naptime cannot be 0 for release build
1: SHOW diskquota.naptime;
 diskquota.naptime 
-------------------
 0                 
(1 row)
--end_ignore
1: SHOW diskquota.max_active_tables;
 diskquota.max_active_tables 
-----------------------------
 307200                      
(1 row)
1: SHOW diskquota.worker_timeout;
 diskquota.worker_timeout 
--------------------------
 60                       
(1 row)
